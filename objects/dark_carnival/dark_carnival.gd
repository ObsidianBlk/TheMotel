extends Node3D

# ------------------------------------------------------------------------------
# Signals
# ------------------------------------------------------------------------------


# ------------------------------------------------------------------------------
# Constants and ENUMs
# ------------------------------------------------------------------------------
const FULL_VOLUME_TIME : float = 10.0

# ------------------------------------------------------------------------------
# Export Variables
# ------------------------------------------------------------------------------
@export var active : bool = false:			set = set_active

# ------------------------------------------------------------------------------
# Variables
# ------------------------------------------------------------------------------
var _volume : float = 0.0

# ------------------------------------------------------------------------------
# Onready Variables
# ------------------------------------------------------------------------------
@onready var _asp: AudioStreamPlayer3D = $AudioStreamPlayer3D


# ------------------------------------------------------------------------------
# Setters / Getters
# ------------------------------------------------------------------------------
func set_active(a : bool) -> void:
	active = a

# ------------------------------------------------------------------------------
# Override Methods
# ------------------------------------------------------------------------------
func _process(delta: float) -> void:
	if active:
		if not is_equal_approx(_volume, FULL_VOLUME_TIME):
			_volume = clampf(_volume + delta, 0.0, FULL_VOLUME_TIME)
			_asp.volume_db = linear_to_db(_volume / FULL_VOLUME_TIME)
			if not _asp.playing:
				_asp.play()
	elif _asp.playing:
		_asp.stop()
		_asp.volume_db = linear_to_db(0.0)
		_volume = 0.0

# ------------------------------------------------------------------------------
# Private Methods
# ------------------------------------------------------------------------------


# ------------------------------------------------------------------------------
# Public Methods
# ------------------------------------------------------------------------------


# ------------------------------------------------------------------------------
# Handler Methods
# ------------------------------------------------------------------------------
